import"./DsnmJJEf.js";import"./BKK0jMZx.js";import{V as n,W as l,X as o}from"./Bnp0l1rp.js";const p={title:"자바스크립트 연산자 오버로딩",description:"자바스크립트에서 연산자 오버로딩(Operator Overloading)을 구현할 수 있을까?",date:"2025-12-02",categories:["Javascript"],tags:["Javascript","Typescript"]},{title:y,description:i,date:D,categories:A,tags:C}=p;var e=n(`<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#의문">의문</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#자바스크립트의-연산자-오버로딩">자바스크립트의 연산자 오버로딩</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#1-형-변환-이용하기">1. 형 변환 이용하기</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#11-숫자-연산-흉내-내기-valueof">1.1 숫자 연산 흉내 내기 (valueOf)</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#12-문자열-연산-흉내-내기-tostring">1.2 문자열 연산 흉내 내기 (toString)</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#13-한계점">1.3 한계점</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#2-연산자-모양을-한-메소드-정의하기">2. 연산자 모양을 한 메소드 정의하기</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#21-메소드-정의">2.1 메소드 정의</a><ol class="toc-level toc-level-4"><li class="toc-item toc-item-h4"><a class="toc-link toc-link-h4" href="#22-한계점">2.2 한계점</a></li></ol></li></ol></li></ol></li></ol></nav><h1 id="의문"><a aria-hidden="true" tabindex="-1" href="#의문"><span class="icon icon-link"></span></a>의문</h1> <p>개발을 하다 보면 종종 이상한 것에 꽂힐 때가 있다.</p> <p>2차원 좌표계(x, y)를 다루는 로직을 작성하던 중에 문득 든 생각이 있었다.</p> <p>두 좌표를 더하는 연산을 구현해야 했는데, 문득 <code>자바나 C++ 같은 언어들의 연산자 오버로딩(Operator Overloading) 기능은 없는걸까?</code> 라는 생각이 들었다.</p> <pre data-code-title="코드"><code><span data-line-number="1"><span style="color: #758575DD">// 현재 방식</span></span>
<span data-line-number="2"><span style="color: #CB7676">const </span><span style="color: #BD976A">cell3</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #BD976A">cell1</span><span style="color: #666666">.</span><span style="color: #80A665">add</span><span style="color: #666666">(</span><span style="color: #BD976A">cell2</span><span style="color: #666666">);</span></span>
<span data-line-number="3"></span>
<span data-line-number="4"><span style="color: #758575DD">// 원하는 방식</span></span>
<span data-line-number="5"><span style="color: #CB7676">const </span><span style="color: #BD976A">result</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #BD976A">cell1</span><span style="color: #CB7676"> + </span><span style="color: #BD976A">cell2</span><span style="color: #666666">;</span></span>
</code></pre> <p>result.x = cell1.x + cell2.x 처럼 풀어서 쓰거나 add 메소드를 만드는 것보다, 직관적으로 + 기호를 쓰고 싶다는 욕망에 사로잡히기 시작했다.</p> <p>“자바스크립트라고 안 될 리가 없지 않나?” 라는 생각으로 구글링을 시작했고, 수년 전 스택오버플로우에서 흥미로운 토론을 찾을 수 있었다.</p> <p>이번 글에서는 자바스크립트에서 연산자 오버로딩을 흉내 내는 몇 가지 꼼수와, 그 끝에 내린 결론을 기록한다.</p> <h1 id="자바스크립트의-연산자-오버로딩"><a aria-hidden="true" tabindex="-1" href="#자바스크립트의-연산자-오버로딩"><span class="icon icon-link"></span></a>자바스크립트의 연산자 오버로딩</h1> <p>자바스크립트는 공식적으로 연산자 오버로딩을 지원하지 않는다. 하지만 자바스크립트의 유연함(혹은 허점)을 이용해 비슷하게 동작하도록 만들 수는 있다.</p> <blockquote><p>예제 코드는 TypeScript로 작성되었습니다.</p></blockquote> <h2 id="1-형-변환-이용하기"><a aria-hidden="true" tabindex="-1" href="#1-형-변환-이용하기"><span class="icon icon-link"></span></a>1. 형 변환 이용하기</h2> <p>자바스크립트 엔진은 객체끼리 연산을 시도할 때, 해당 객체를 원시값(Primitive)으로 변환한다. 이때 호출되는 valueOf나 toString 메소드를 가로채는 방법이다.</p> <h3 id="11-숫자-연산-흉내-내기-valueof"><a aria-hidden="true" tabindex="-1" href="#11-숫자-연산-흉내-내기-valueof"><span class="icon icon-link"></span></a>1.1 숫자 연산 흉내 내기 (valueOf)</h3> <pre data-code-title="valueOf를 이용한 형 변환 방식"><code><span data-line-number="1"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">Thing</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">constructor</span><span style="color: #666666">(</span><span style="color: #CB7676">private</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">value</span><span style="color: #666666">: </span><span style="color: #5DA9A7">number</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;&#125;</span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">    </span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">    </span><span style="color: #80A665">valueOf</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">      </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">value</span><span style="color: #666666">;</span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">    </span><span style="color: #666666">&#125;</span></span>
<span data-line-number="7"><span style="color: #666666">&#125;</span></span>
<span data-line-number="8"></span>
<span data-line-number="9"><span style="color: #CB7676">const </span><span style="color: #BD976A">a</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">Thing</span><span style="color: #666666">(</span><span style="color: #4C9A91">1</span><span style="color: #666666">);</span></span>
<span data-line-number="10"><span style="color: #CB7676">const </span><span style="color: #BD976A">b</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">Thing</span><span style="color: #666666">(</span><span style="color: #4C9A91">3</span><span style="color: #666666">);</span></span>
<span data-line-number="11"></span>
<span data-line-number="12"><span style="color: #758575DD">// @ts-ignore: TS2365 에러 무시 (TypeScript는 이를 허용하지 않음)</span></span>
<span data-line-number="13"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">a</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">+</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">b</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// 출력: 4</span></span>
</code></pre> <h3 id="12-문자열-연산-흉내-내기-tostring"><a aria-hidden="true" tabindex="-1" href="#12-문자열-연산-흉내-내기-tostring"><span class="icon icon-link"></span></a>1.2 문자열 연산 흉내 내기 (toString)</h3> <pre data-code-title="toString을 이용한 형 변환 방식"><code><span data-line-number="1"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">ThingStr</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">constructor</span><span style="color: #666666">(</span><span style="color: #CB7676">private</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">val</span><span style="color: #666666">: </span><span style="color: #5DA9A7">string</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;&#125;</span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">    </span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">    </span><span style="color: #80A665">toString</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">      </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">val</span><span style="color: #666666">.</span><span style="color: #80A665">toUpperCase</span><span style="color: #666666">();</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">    </span><span style="color: #666666">&#125;</span></span>
<span data-line-number="7"><span style="color: #666666">&#125;</span></span>
<span data-line-number="8"></span>
<span data-line-number="9"><span style="color: #CB7676">const </span><span style="color: #BD976A">a</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">ThingStr</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">a</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="10"><span style="color: #CB7676">const </span><span style="color: #BD976A">b</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">ThingStr</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">b</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">);</span></span>
<span data-line-number="11"></span>
<span data-line-number="12"><span style="color: #758575DD">// @ts-ignore</span></span>
<span data-line-number="13"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">a</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">+</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">b</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// 출력: AB</span></span>
</code></pre> <h3 id="13-한계점"><a aria-hidden="true" tabindex="-1" href="#13-한계점"><span class="icon icon-link"></span></a>1.3 한계점</h3> <p>이 방식은 런타임에서 4나 “AB” 같은 원시값을 뱉어낼 뿐, 새로운 객체(인스턴스)를 반환하지 않는다.</p> <p>원하는 객체 연산(Ex. Vector + Vector = Vector)을 구현하기에는 적합하지 않다.
게다가 TypeScript에서는 <code>The operator + cannot be applied to types...</code>라는 에러를 뿜어내며 잘못된 패턴이라고 알려주기까지 한다.</p> <h2 id="2-연산자-모양을-한-메소드-정의하기"><a aria-hidden="true" tabindex="-1" href="#2-연산자-모양을-한-메소드-정의하기"><span class="icon icon-link"></span></a>2. 연산자 모양을 한 메소드 정의하기</h2> <h3 id="21-메소드-정의"><a aria-hidden="true" tabindex="-1" href="#21-메소드-정의"><span class="icon icon-link"></span></a>2.1 메소드 정의</h3> <p>해당 코드는 스택 오버플로우를 적극 차용한 코드다. 처음 이 코드를 보았을 때, 자바스크립트의 특징을 진짜 잘 이용했다는 생각이 들었다.</p> <p>자바스크립트 객체의 키에는 문자열이 들어갈 수 있다는 점을 이용한 상상도 못했던 코드였다.</p> <pre data-code-title="메소드를 연산자 기호로 만드는 방식"><code><span data-line-number="1"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">Vector2</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">constructor</span><span style="color: #666666">(</span><span style="color: #CB7676">public</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">x</span><span style="color: #666666">: </span><span style="color: #5DA9A7">number</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">public</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">y</span><span style="color: #666666">: </span><span style="color: #5DA9A7">number</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;&#125;</span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">    </span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">    </span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">+</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">(</span><span style="color: #BD976A">vector</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Vector2</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">      </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">new</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">Vector2</span><span style="color: #666666">(</span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">x</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">+</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">vector</span><span style="color: #666666">.</span><span style="color: #BD976A">x</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">y</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">+</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">vector</span><span style="color: #666666">.</span><span style="color: #BD976A">y</span><span style="color: #666666">);</span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">    </span><span style="color: #666666">&#125;</span></span>
<span data-line-number="7"><span style="color: #DBD7CAEE">    </span></span>
<span data-line-number="8"><span style="color: #DBD7CAEE">    </span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">==</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">(</span><span style="color: #BD976A">vector</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Vector2</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="9"><span style="color: #DBD7CAEE">      </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">x</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">===</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">vector</span><span style="color: #666666">.</span><span style="color: #BD976A">x</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">&amp;&amp;</span><span style="color: #DBD7CAEE"> </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">y</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">===</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">vector</span><span style="color: #666666">.</span><span style="color: #BD976A">y</span><span style="color: #666666">;</span></span>
<span data-line-number="10"><span style="color: #DBD7CAEE">    </span><span style="color: #666666">&#125;</span></span>
<span data-line-number="11"><span style="color: #DBD7CAEE">    </span></span>
<span data-line-number="12"><span style="color: #DBD7CAEE">    </span><span style="color: #80A665">toString</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">&#123;</span></span>
<span data-line-number="13"><span style="color: #DBD7CAEE">      </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">&#96;</span><span style="color: #C98A7D">Vector2 [</span><span style="color: #666666">$&#123;</span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #C98A7D">x</span><span style="color: #666666">&#125;</span><span style="color: #C98A7D">, </span><span style="color: #666666">$&#123;</span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #C98A7D">y</span><span style="color: #666666">&#125;</span><span style="color: #C98A7D">]</span><span style="color: #C98A7DAA">&#96;</span><span style="color: #666666">;</span></span>
<span data-line-number="14"><span style="color: #DBD7CAEE">    </span><span style="color: #666666">&#125;</span></span>
<span data-line-number="15"><span style="color: #666666">&#125;;</span></span>
<span data-line-number="16"></span>
<span data-line-number="17"><span style="color: #CB7676">const </span><span style="color: #BD976A">vec1</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">Vector2</span><span style="color: #666666">(</span><span style="color: #4C9A91">10</span><span style="color: #666666">,</span><span style="color: #CB7676"> </span><span style="color: #4C9A91">20</span><span style="color: #666666">);</span></span>
<span data-line-number="18"><span style="color: #CB7676">const </span><span style="color: #BD976A">vec2</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">Vector2</span><span style="color: #666666">(</span><span style="color: #4C9A91">20</span><span style="color: #666666">,</span><span style="color: #CB7676"> </span><span style="color: #4C9A91">30</span><span style="color: #666666">);</span></span>
<span data-line-number="19"><span style="color: #CB7676">const </span><span style="color: #BD976A">vec3</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> new </span><span style="color: #80A665">Vector2</span><span style="color: #666666">(</span><span style="color: #4C9A91">1</span><span style="color: #666666">,</span><span style="color: #CB7676"> </span><span style="color: #4C9A91">2</span><span style="color: #666666">);</span></span>
<span data-line-number="20"></span>
<span data-line-number="21"><span style="color: #CB7676">const </span><span style="color: #BD976A">sumVec</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #666666">(</span><span style="color: #BD976A">vec1</span><span style="color: #666666">)[</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">+</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">](</span><span style="color: #BD976A">vec2</span><span style="color: #666666">)[</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">+</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">](</span><span style="color: #BD976A">vec3</span><span style="color: #666666">);</span></span>
<span data-line-number="22"><span style="color: #CB7676">const </span><span style="color: #BD976A">isEqual</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #666666">(</span><span style="color: #BD976A">vec1</span><span style="color: #666666">)[</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #C98A7D">==</span><span style="color: #C98A7DAA">&quot;</span><span style="color: #666666">](</span><span style="color: #BD976A">vec2</span><span style="color: #666666">);</span></span>
<span data-line-number="23"></span>
<span data-line-number="24"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">&#96;</span><span style="color: #666666">$&#123;</span><span style="color: #C98A7D">sumVec</span><span style="color: #666666">&#125;</span><span style="color: #C98A7DAA">&#96;</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// Vector2 [31, 52]</span></span>
</code></pre> <h4 id="22-한계점"><a aria-hidden="true" tabindex="-1" href="#22-한계점"><span class="icon icon-link"></span></a>2.2 한계점</h4> <p><code>vec1 + vec2</code>가 아니라 <code>vec1 ["+"] (vec2)</code>라니… 참신하긴 하지만 가독성이 절망적이다.</p> <p>원리는 동일하고, <code>add</code>를 <code>+</code>로 바꾸기만 한 것 일뿐…</p> <p>일반적인 메소드 호출(add)보다 타이핑하기도 어렵고, 기존 코드와 완전히 다른 형식에 이 코드를 읽는 사람들의 가독성도 심하게 해친다.</p> <p>여러 꼼수들을 직접 구현해 보고 나서야 깨달은 것들</p> <ul><li>언어의 설계를 거스르지 말자 <ul><li>자바스크립트가 연산자 오버로딩을 지원하지 않는 데에는 이유가 있다.</li> <li><a href="https://github.com/tc39/proposal-operator-overloading" rel="nofollow">TC39 Proposal: Operator Overloading</a></li></ul></li> <li>가독성의 재정의 <ul><li><ul><li>기호를 쓰는 것이 수학적으로는 아름다울지 몰라도, 프로그래밍 관점에서는 add()라는 명시적인 메소드가 훨씬 읽기 좋고 예측 가능하다.</li></ul></li> <li>또한, 굳이 연산자 오버로딩이 필요한 작업이냐고 가독성에 대해 다시 생각해보라는 의견도 상당히 있었다.</li></ul></li></ul> <p>Cell1 + Cell2에 대한 미련을 버리고, 얌전히 <code>Cell1.add(Cell2)</code>를 구현하여 사용하기로 했다.</p>`,1);function B(s){var a=e();o(63),l(s,a)}export{B as default,p as metadata};
