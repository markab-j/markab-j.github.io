<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    
		<link href="../_app/immutable/assets/0.DNAZ0I-c.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.ChMxvzUG.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/khrmUelp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/kdTHykGj.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/Bnp0l1rp.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D0iwhpLH.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DjUvtmSg.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.BFT2A5C2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/PPVm8Dsz.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/DsnmJJEf.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CXjft6v8.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CZxCv9VC.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/B_wVCKFn.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D29xPeYc.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.D6zhKBd9.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BnpJiuoK.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CqkleIqs.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/D8iWDPq2.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BKK0jMZx.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/_AuKuasQ.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BR7wxYWc.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CuNgCV5T.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/CCcTBLnX.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/0JNfDbnS.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/7nLPwoo4.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/5.B3wQz1i_.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/BAnjKx80.js"><!--[--><link rel="icon" href="/favicon.svg"/><!--]--><!--[--><!--[!--><!--]--> <!----><script>(function setInitialMode({ defaultMode = "system", themeColors: themeColors2, darkClassNames: darkClassNames2 = ["dark"], lightClassNames: lightClassNames2 = [], defaultTheme = "", modeStorageKey: modeStorageKey2 = "mode-watcher-mode", themeStorageKey: themeStorageKey2 = "mode-watcher-theme" }) {
  const rootEl = document.documentElement;
  const mode = localStorage.getItem(modeStorageKey2) ?? defaultMode;
  const theme = localStorage.getItem(themeStorageKey2) ?? defaultTheme;
  const light = mode === "light" || mode === "system" && window.matchMedia("(prefers-color-scheme: light)").matches;
  if (light) {
    if (darkClassNames2.length)
      rootEl.classList.remove(...darkClassNames2.filter(Boolean));
    if (lightClassNames2.length)
      rootEl.classList.add(...lightClassNames2.filter(Boolean));
  } else {
    if (lightClassNames2.length)
      rootEl.classList.remove(...lightClassNames2.filter(Boolean));
    if (darkClassNames2.length)
      rootEl.classList.add(...darkClassNames2.filter(Boolean));
  }
  rootEl.style.colorScheme = light ? "light" : "dark";
  if (themeColors2) {
    const themeMetaEl = document.querySelector('meta[name="theme-color"]');
    if (themeMetaEl) {
      themeMetaEl.setAttribute("content", mode === "light" ? themeColors2.light : themeColors2.dark);
    }
  }
  if (theme) {
    rootEl.setAttribute("data-theme", theme);
    localStorage.setItem(themeStorageKey2, theme);
  }
  localStorage.setItem(modeStorageKey2, mode);
})({"defaultMode":"system","darkClassNames":["dark"],"lightClassNames":[],"defaultTheme":"","modeStorageKey":"mode-watcher-mode","themeStorageKey":"mode-watcher-theme"});</script><!----><!--]--><!--[--><meta data-key="description" name="description" content="자바스크립트 Reflect API 찍어먹기"/> <meta property="og:type" content="article"/> <meta property="og:title" content="자바스크립트 Reflect API"/> <meta name="twitter:title" content="자바스크립트 Reflect API"/> <meta property="og:description" content="자바스크립트 Reflect API 찍어먹기"/> <meta name="twitter:description" content="자바스크립트 Reflect API 찍어먹기"/> <meta property="og:image:width" content="undefined"/> <meta property="og:image:height" content="undefined"/><!--]--><title>자바스크립트 Reflect API</title>
  </head>
  <body data-sveltekit-preload-data="hover">
    <div style="display: contents"><!--[--><!--[--><!----><!--[!--><!--]--><!----> <div class="flex min-h-screen flex-col"><header class="fixed inset-x-0 top-0 z-50 p-4"><div class="dark:bg-secondary/50 mx-auto flex min-h-16 max-w-4xl items-center justify-between overflow-hidden rounded-2xl bg-white/50 px-4 py-2 shadow-lg ring-1 ring-black/5 backdrop-blur-sm"><div class="pointer-events-none absolute inset-0 rounded-[inherit] border-[length:var(--border-beam-width)] border-transparent [mask-image:linear-gradient(transparent,transparent),linear-gradient(#000,#000)] [mask-composite:intersect] [mask-clip:padding-box,border-box]" style="--border-beam-width: 1px;"><!----><!----><!----><!----><!--[--><!----><!----><!----><!----><!----><!----><!----><!----><div class="absolute aspect-square bg-gradient-to-l from-[var(--color-from)] via-[var(--color-to)] to-transparent" style=" width: 60px; offset-path: rect(0 auto auto 0 round 60px); --color-from: #AAA; --color-to: #AAA;  "></div><!----><!----><!----><!----><!----><!----><!----><!----> <!--[!--><!--]--><!----><!--]--><!----><!----><!----><!----><!----></div><!----> <!--[--><!--]--><!----> <a href="../" aria-label="Go Home"><img src="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20viewBox='0%200%20512%20523'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='256'%20cy='267'%20r='256'%20fill='currentColor'/%3e%3cpath%20d='M227.483%20309.754V138.172H282.854V309.754C282.854%20326.388%20279.095%20340.743%20271.575%20352.82C264.17%20364.783%20254.087%20374.069%20241.326%20380.677C228.68%20387.171%20214.381%20390.418%20198.431%20390.418C182.024%20390.418%20167.441%20387.684%20154.681%20382.215C141.92%20376.632%20131.894%20368.144%20124.603%20356.751C117.425%20345.244%20113.836%20330.604%20113.836%20312.83H169.549C169.549%20321.603%20170.631%20328.553%20172.796%20333.68C175.075%20338.693%20178.379%20342.225%20182.708%20344.275C187.037%20346.326%20192.278%20347.352%20198.431%20347.352C204.355%20347.352%20209.482%20345.927%20213.812%20343.079C218.141%20340.117%20221.502%20335.844%20223.895%20330.262C226.287%20324.565%20227.483%20317.729%20227.483%20309.754Z'%20fill='white'/%3e%3cpath%20d='M282.068%20179.565V325H228.577V140.088H278.821L282.068%20179.565ZM275.062%20226.05L261.731%20226.392C261.731%20212.492%20263.44%20200.016%20266.858%20188.965C270.276%20177.913%20275.118%20168.514%20281.385%20160.767C287.765%20152.905%20295.341%20146.924%20304.114%20142.822C313.001%20138.721%20322.799%20136.67%20333.509%20136.67C342.168%20136.67%20350.086%20137.923%20357.264%20140.43C364.441%20142.936%20370.594%20146.981%20375.721%20152.563C380.962%20158.032%20384.949%20165.324%20387.684%20174.438C390.418%20183.439%20391.785%20194.548%20391.785%20207.764V325H338.123V207.593C338.123%20199.845%20337.041%20193.864%20334.876%20189.648C332.711%20185.433%20329.521%20182.471%20325.306%20180.762C321.204%20179.053%20316.191%20178.198%20310.267%20178.198C304%20178.198%20298.646%20179.451%20294.202%20181.958C289.759%20184.351%20286.113%20187.712%20283.265%20192.041C280.416%20196.37%20278.309%20201.44%20276.941%20207.251C275.688%20213.062%20275.062%20219.328%20275.062%20226.05Z'%20fill='white'/%3e%3crect%20x='225'%20y='194'%20width='60'%20height='40'%20fill='currentColor'/%3e%3c/svg%3e" alt="Blog Logo" class="size-8"/></a> <nav class="flex gap-4"><ul class="flex items-center space-x-6 text-sm font-medium"><!--[--><li><a href="../about" class="hover:text-foreground/50 transition-colors duration-200">About</a></li><li><a href="../blog" class="hover:text-foreground/50 transition-colors duration-200">Blog</a></li><li><a href="../projects" class="hover:text-foreground/50 transition-colors duration-200">Project</a></li><!--]--></ul> <div class="flex items-center space-x-4 px-2"><button type="button" aria-label="theme toggle" class="hover:text-foreground/50 relative size-5"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-sun absolute inset-0 size-5 !transition-transform duration-300 [backface-visibility:hidden] dark:[transform:rotateY(180deg)]"><!--[--><!----><circle cx="12" cy="12" r="4"><!----></circle><!----><!----><path d="M12 2v2"><!----></path><!----><!----><path d="M12 20v2"><!----></path><!----><!----><path d="m4.93 4.93 1.41 1.41"><!----></path><!----><!----><path d="m17.66 17.66 1.41 1.41"><!----></path><!----><!----><path d="M2 12h2"><!----></path><!----><!----><path d="M20 12h2"><!----></path><!----><!----><path d="m6.34 17.66-1.41 1.41"><!----></path><!----><!----><path d="m19.07 4.93-1.41 1.41"><!----></path><!----><!--]--><!----><!----></svg><!----> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-moon absolute inset-0 size-5 [transform:rotateY(180deg)] !transition-transform duration-300 [backface-visibility:hidden] dark:[transform:rotateY(360deg)]"><!--[--><!----><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"><!----></path><!----><!--]--><!----><!----></svg><!----></button><!----></div></nav></div></header><!----> <main class="w-full flex-1"><!----><article class="mt-header mx-auto w-full max-w-3xl px-4 pb-36"><header class="mb-8 text-center md:mb-12"><!--[!--><!--]--> <section class="mb-4 flex flex-wrap justify-center gap-2"><!--[--><div class="border-border rounded-xl border px-1.5 py-0.5"><a class="text-primary/70 hover:text-primary text-sm transition-colors duration-200" href="/blog?category=Javascript">Javascript</a></div><!--]--></section> <h1 class="mb-4 text-3xl font-bold break-words break-keep md:text-5xl">자바스크립트 Reflect API</h1> <section class="flex items-center justify-center space-x-4 text-sm text-gray-500 dark:text-gray-400"><div class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-calendar size-4"><!--[--><!----><path d="M8 2v4"><!----></path><!----><!----><path d="M16 2v4"><!----></path><!----><!----><rect width="18" height="18" x="3" y="4" rx="2"><!----></rect><!----><!----><path d="M3 10h18"><!----></path><!----><!--]--><!----><!----></svg><!----> <span>2025. 12. 02</span></div></section></header> <section class="prose dark:prose-invert prose-lime max-w-none"><!----> <nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#reflection이란">Reflection이란</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#메서드-정리">메서드 정리</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#apply">apply</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#construct">construct</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#defineproperty">defineProperty</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#deleteproperty">deleteProperty</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#get">get</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#private-속성에도-접근할-수-있을까">Private 속성에도 접근할 수 있을까?</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#getownpropertydescriptor">getOwnPropertyDescriptor</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#descriptor란">Descriptor란</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#getprototypeof">getPrototypeOf</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#has">has</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#isextensible">isExtensible</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#ownkeys">ownKeys</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#preventextensions">preventExtensions</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#set">set</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#setprototypeof">setPrototypeOf</a></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#그래서-reflect-언제-사용될까">그래서 Reflect 언제 사용될까?</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#메타-프로그래밍이란">메타 프로그래밍이란</a></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#reflect-metadata">reflect-metadata</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#nestjs에서-reflect-metadata의-실제-활용">NestJS에서 reflect-metadata의 실제 활용</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#nestjs의-injectable-흉내내기">Nestjs의 Injectable 흉내내기</a></li></ol></li></ol></nav><h1 id="reflection이란"><a aria-hidden="true" tabindex="-1" href="#reflection이란"><span class="icon icon-link"></span></a>Reflection이란</h1> <p>Reflection에 관한 정보를 찾아보면 자바의 Reflection API를 주로 찾을 수 있다.
대부분의 글에서는 <code>런타임에 클래스나 멤버를 조사하고 조작할 수 있는 기능</code>으로 정의하고 있다.</p> <p>자바스크립트에는 유사한 Reflect API가 존재한다. 정리해본 결과 이름은 유사하지만 실제 동작은 자바의 Reflection API와는 조금 달랐다.</p> <blockquote><p><a href="https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/Reflect" rel="nofollow">MDN Doc - Reflect</a>을 참고하여 작성되었습니다.</p></blockquote> <h1 id="메서드-정리"><a aria-hidden="true" tabindex="-1" href="#메서드-정리"><span class="icon icon-link"></span></a>메서드 정리</h1> <h2 id="apply"><a aria-hidden="true" tabindex="-1" href="#apply"><span class="icon icon-link"></span></a>apply</h2> <blockquote><p>대상 함수를 매개변수로 호출한다.</p></blockquote> <p>Function.prototype.apply()와 동일한 동작을 수행하는 것을 알 수 있다.
그렇다면 왜 굳이 Reflect.apply를 제공해주는걸까?</p> <ol><li>함수의 apply는 외부에서 오버라이드할 가능성이 존재한다.</li></ol> <pre><code><span data-line-number="1"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">hack</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">	</span><span style="color: #80A665">apply</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=></span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">hacked</span><span style="color: #C98A7DAA">'</span></span>
<span data-line-number="3"><span style="color: #666666">};</span></span>
<span data-line-number="4"></span>
<span data-line-number="5"><span style="color: #CB7676">function</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">sayHi</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">	</span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">Hi</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">;</span></span>
<span data-line-number="7"><span style="color: #666666">}</span></span>
<span data-line-number="8"></span>
<span data-line-number="9"><span style="color: #BD976A">sayHi</span><span style="color: #666666">.</span><span style="color: #BD976A">apply</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">hack</span><span style="color: #666666">.</span><span style="color: #BD976A">apply</span><span style="color: #666666">;</span></span>
<span data-line-number="10"></span>
<span data-line-number="11"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">sayHi</span><span style="color: #666666">.</span><span style="color: #80A665">apply</span><span style="color: #666666">());</span><span style="color: #DBD7CAEE">            </span><span style="color: #758575DD">// 'hacked'</span></span>
<span data-line-number="12"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">apply</span><span style="color: #666666">(</span><span style="color: #BD976A">sayHi</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">null</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">[]));</span><span style="color: #DBD7CAEE">   </span><span style="color: #758575DD">// 'Hi'</span></span>
</code></pre> <p>악의적으로 오버라이드한다면 의도하지 않은 동작이 발생할 수 있다.</p> <ol start="2"><li>프록시 트랩을 구현할 경우</li></ol> <pre><code><span data-line-number="1"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">fn</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">function</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">(</span><span style="color: #BD976A">a</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">b</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">  </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">a</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">+</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">b</span><span style="color: #666666">;</span></span>
<span data-line-number="3"><span style="color: #666666">};</span></span>
<span data-line-number="4"></span>
<span data-line-number="5"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">proxy</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">new</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">Proxy</span><span style="color: #666666">(</span><span style="color: #BD976A">fn</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">  </span><span style="color: #80A665">apply</span><span style="color: #666666">(</span><span style="color: #BD976A">target</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">thisArg</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">argumentsList</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="7"><span style="color: #DBD7CAEE">    </span><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">`</span><span style="color: #C98A7D">called with:</span><span style="color: #C98A7DAA">`</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">argumentsList</span><span style="color: #666666">);</span></span>
<span data-line-number="8"><span style="color: #DBD7CAEE">    </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">apply</span><span style="color: #666666">(</span><span style="color: #BD976A">target</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">thisArg</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">argumentsList</span><span style="color: #666666">);</span></span>
<span data-line-number="9"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span></span>
<span data-line-number="10"><span style="color: #666666">});</span></span>
<span data-line-number="11"></span>
<span data-line-number="12"><span style="color: #80A665">proxy</span><span style="color: #666666">(</span><span style="color: #4C9A91">1</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #4C9A91">2</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// called with: [1, 2] → 3</span></span>
</code></pre> <p>프록시 트랩을 구현하는 경우에는 Reflect API를 사용하는 방식이 권장된다. 이 경우에도 1번의 경우처럼 악의적으로 오버라이드하여 오염시키는 경우에도 정상적으로 동작하게 된다.</p> <blockquote><p>하지만 이 경우에도 Reflect.apply 자체를 오버라이드하면 오염되고 만다.</p></blockquote> <p>이에 대한 방지법은 구조분해할당으로 캡처하는 것이 존재하지만, 대형 프로젝트(Vue 3 Core)에서도 Reflect를 굳이 구조분해할당하여 사용하지 않는 것으로 보인다.</p> <h2 id="construct"><a aria-hidden="true" tabindex="-1" href="#construct"><span class="icon icon-link"></span></a>construct</h2> <blockquote><p>함수로써 사용하는 new 연산자.
new target(…args)와 동일한 동작이다.</p></blockquote> <p>다른 프로토타입을 지정하는 추가 기능도 존재한다.
런타임에 어떤 클래스를 사용하여 인스턴스를 생성할지 결정할 수 있다.</p> <pre><code><span data-line-number="1"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">Base</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">  </span><span style="color: #BD976A">kind</span><span style="color: #666666">: </span><span style="color: #5DA9A7">string</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">  </span><span style="color: #CB7676">constructor</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">    </span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">kind</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">new</span><span style="color: #666666">.</span><span style="color: #B8A965">target</span><span style="color: #666666">.</span><span style="color: #BD976A">name</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="6"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="7"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="8"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">A</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">extends</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">Base</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="9"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">B</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">extends</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">Base</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="10"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="11"><span style="color: #CB7676">function</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">createInstance</span><span style="color: #666666">(</span><span style="color: #80A665">baseCtor</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Function</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">childCtor</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Function</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="12"><span style="color: #DBD7CAEE">  </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">construct</span><span style="color: #666666">(</span><span style="color: #BD976A">baseCtor</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">[],</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">childCtor</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="13"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="14"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="15"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">a</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">createInstance</span><span style="color: #666666">(</span><span style="color: #BD976A">Base</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">A</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="16"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">b</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">createInstance</span><span style="color: #666666">(</span><span style="color: #BD976A">Base</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">B</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="17"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="18"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">a</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// A  </span></span>
<span data-line-number="19"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">b</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// B</span></span>
</code></pre> <h2 id="defineproperty"><a aria-hidden="true" tabindex="-1" href="#defineproperty"><span class="icon icon-link"></span></a>defineProperty</h2> <blockquote><p>Object.defineProperty와 비슷하다. Boolean을 반환한다.</p></blockquote> <p>그럼 굳이 Reflect로 defineProperty를 해야할 이유가 있을까?</p> <p>차이점은 실제로 속성을 생성할 수 없을 경우에 발생한다.
Object에 존재하는 메서드로 시도하면 TypeError가 발생하지만
Reflect로 시도하면 단순히 결과가 true, false로 반환되는 큰 차이점이 존재한다.</p> <p>따라서 Reflect로 코드를 작성하게 된다면 에러처리 부분이 단순화되는 장점을 가져올 수 있다.</p> <pre><code><span data-line-number="1"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">obj</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">Object</span><span style="color: #666666">.</span><span style="color: #80A665">freeze</span><span style="color: #666666">({});</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="3"><span style="color: #4D9375">try</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">  </span><span style="color: #BD976A">Object</span><span style="color: #666666">.</span><span style="color: #80A665">defineProperty</span><span style="color: #666666">(</span><span style="color: #BD976A">obj</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">key</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE"> </span><span style="color: #B8A965">value</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4C9A91">123</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">});</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="5"><span style="color: #666666">}</span><span style="color: #DBD7CAEE"> </span><span style="color: #4D9375">catch</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">(</span><span style="color: #BD976A">e</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">  </span><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">error</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">에러 발생:</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">e</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// throw 됨  </span></span>
<span data-line-number="7"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="8"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="9"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">result</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">defineProperty</span><span style="color: #666666">(</span><span style="color: #BD976A">obj</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">key</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE"> </span><span style="color: #B8A965">value</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4C9A91">123</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">});</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="10"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">result</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// false</span></span>
</code></pre> <h2 id="deleteproperty"><a aria-hidden="true" tabindex="-1" href="#deleteproperty"><span class="icon icon-link"></span></a>deleteProperty</h2> <blockquote><p>delete obj[prop]과 동일한 동작을 수행한다.</p></blockquote> <h2 id="get"><a aria-hidden="true" tabindex="-1" href="#get"><span class="icon icon-link"></span></a>get</h2> <blockquote><p>속성 값을 반환한다. <code>obj[prop]</code>과 동일한 동작을 수행한다.</p></blockquote> <pre><code><span data-line-number="1"><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">get</span><span style="color: #666666">(</span><span style="color: #BD976A">obj</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">key</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">)</span></span>
</code></pre> <p>프록시 트랩에서 <code>get</code>을 정의할 때, 원래 값을 가져오려면 <code>Reflect.get</code>을 사용해야 한다. <code>receiver</code>를 지정해 <code>this</code> 바인딩을 컨트롤할 수도 있다.</p> <h3 id="private-속성에도-접근할-수-있을까"><a aria-hidden="true" tabindex="-1" href="#private-속성에도-접근할-수-있을까"><span class="icon icon-link"></span></a>Private 속성에도 접근할 수 있을까?</h3> <p>자바에서 Reflection API는 Private 속성에도 접근할 수 있는 아주 강력한 API인데 자바스크립트도 동일할까?</p> <p>답은 <code>아니다</code></p> <p>자바스크립트의 설계상 특별한 내부 슬롯으로 관리되어 절대 접근할 수 없다.</p> <blockquote><p>private 필드는 Reflect 뿐 아니라 <code>Object.keys</code>, <code>for...in</code>, <code>JSON.stringify</code> 등 모든 일반적인 접근 방식에서 감춰진다.</p></blockquote> <p><strong>프레임워크 레벨에서도 <code>#</code> 필드는 접근 불가능하다는 점</strong>을 반드시 인지하고 설계해야 한다.</p> <h2 id="getownpropertydescriptor"><a aria-hidden="true" tabindex="-1" href="#getownpropertydescriptor"><span class="icon icon-link"></span></a>getOwnPropertyDescriptor</h2> <blockquote><p><code>Object.getOwnPropertyDescriptor()</code>와 유사하게, 대상 객체의 <strong>자체 속성</strong>에 대한 디스크립터(descriptor)를 반환한다.</p></blockquote> <pre><code><span data-line-number="1"><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">getOwnPropertyDescriptor</span><span style="color: #666666">(</span><span style="color: #BD976A">target</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">propertyKey</span><span style="color: #666666">)</span></span>
</code></pre> <h3 id="descriptor란"><a aria-hidden="true" tabindex="-1" href="#descriptor란"><span class="icon icon-link"></span></a>Descriptor란</h3> <p>자바스크립트에서 객체의 각 속성(property)은 단순히 값(value)만 갖는 것이 아니라, 다양한 속성 메타데이터(descriptor)를 가지고 있다.</p> <p>이러한 메타데이터는 <code>Object.getOwnPropertyDescriptor()</code>나 <code>Reflect.getOwnPropertyDescriptor()</code>를 통해 조회할 수 있으며, <code>Object.defineProperty()</code> 등을 통해 직접 설정할 수도 있다.</p> <p>또한 Object.seal, Object.freeze같은 메서드들은 이런 속성 메타데이터를 변경하는 것으로 구현된다.</p> <ul><li><code>Object.preventExtensions(obj)</code><br/> → 확장만 막는다 (<code>새로운 속성 추가 불가</code>)</li> <li><code>Object.seal(obj)</code><br/> → 확장도 막고, 기존 속성의 <code>configurable: false</code>로 설정</li> <li><code>Object.freeze(obj)</code><br/> → seal 효과 + 모든 <code>writable: false</code>로 설정 (값도 변경 불가)</li></ul> <pre><code><span data-line-number="1"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">obj</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{};</span></span>
<span data-line-number="2"></span>
<span data-line-number="3"><span style="color: #BD976A">Object</span><span style="color: #666666">.</span><span style="color: #80A665">defineProperty</span><span style="color: #666666">(</span><span style="color: #BD976A">obj</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">x</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="4"><span style="color: #DBD7CAEE">  </span><span style="color: #B8A965">value</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4C9A91">42</span><span style="color: #666666">,</span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">  </span><span style="color: #B8A965">writable</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4D9375">false</span><span style="color: #666666">,</span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">  </span><span style="color: #B8A965">enumerable</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4D9375">true</span><span style="color: #666666">,</span></span>
<span data-line-number="7"><span style="color: #DBD7CAEE">  </span><span style="color: #B8A965">configurable</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4D9375">false</span></span>
<span data-line-number="8"><span style="color: #666666">});</span></span>
<span data-line-number="9"></span>
<span data-line-number="10"><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">getOwnPropertyDescriptor</span><span style="color: #666666">(</span><span style="color: #BD976A">obj</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">x</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">));</span></span>
</code></pre> <blockquote><p>일반 객체 리터럴 <code>{}</code>로 만든 속성들은 기본적으로</p> <pre><code><span data-line-number="1"><span>writable: true</span></span>
<span data-line-number="2"><span>enumerable: true</span></span>
<span data-line-number="3"><span>configurable: true</span></span>
</code></pre> <p>로 설정된다.
반면, <code>Object.defineProperty()</code>로 생성하는 속성은 디폴트가 모두 <code>false</code>임에 유의하자.</p></blockquote> <h2 id="getprototypeof"><a aria-hidden="true" tabindex="-1" href="#getprototypeof"><span class="icon icon-link"></span></a>getPrototypeOf</h2> <blockquote><p><code>Object.getPrototypeOf</code>)와 같다.</p></blockquote> <h2 id="has"><a aria-hidden="true" tabindex="-1" href="#has"><span class="icon icon-link"></span></a>has</h2> <blockquote><p><code>in</code> 연산자와 같다.<br/> <code>key in obj</code>와 동일한 동작을 수행한다.</p></blockquote> <h2 id="isextensible"><a aria-hidden="true" tabindex="-1" href="#isextensible"><span class="icon icon-link"></span></a>isExtensible</h2> <blockquote><p><code>Object.isExtensible()</code>와 같다.<br/> 객체에 새로운 속성을 추가할 수 있는지 여부를 Boolean으로 반환한다.</p></blockquote> <h2 id="ownkeys"><a aria-hidden="true" tabindex="-1" href="#ownkeys"><span class="icon icon-link"></span></a>ownKeys</h2> <blockquote><p>객체의 모든 자체 키를 반환한다.<br/> <code>Object.getOwnPropertyNames()</code> + <code>Object.getOwnPropertySymbols()</code>와 같다.</p></blockquote> <h2 id="preventextensions"><a aria-hidden="true" tabindex="-1" href="#preventextensions"><span class="icon icon-link"></span></a>preventExtensions</h2> <blockquote><p><code>Object.preventExtensions()</code>와 같다.<br/> 객체에 <strong>새로운 속성을 추가하지 못하게 만든다.</strong><br/> 성공 여부를 Boolean으로 반환한다.</p></blockquote> <h2 id="set"><a aria-hidden="true" tabindex="-1" href="#set"><span class="icon icon-link"></span></a>set</h2> <blockquote><p><code>obj[prop] = value</code>와 같은 동작을 수행한다.<br/> 속성 할당 성공 여부를 Boolean으로 반환한다.</p></blockquote> <p>읽기 전용 속성이나 <code>Object.preventExtensions()</code>된 객체 등에 값을 할당하면 <code>false</code>를 반환한다.</p> <h2 id="setprototypeof"><a aria-hidden="true" tabindex="-1" href="#setprototypeof"><span class="icon icon-link"></span></a>setPrototypeOf</h2> <blockquote><p><code>Object.setPrototypeOf()</code>와 같다.<br/> 객체의 프로토타입을 설정하고, 성공 여부를 Boolean으로 반환한다.</p></blockquote> <p>아래와 같이 전혀 연관이 없어보이는 객체여도 프로토타입을 강제로 변환할 수 있다.</p> <pre><code><span data-line-number="1"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">dog</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">bark</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">짖기!</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">};</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="2"><span style="color: #CB7676">const</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">car</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">=</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE"> </span><span style="color: #B8A965">wheels</span><span style="color: #666666">:</span><span style="color: #DBD7CAEE"> </span><span style="color: #4C9A91">4</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">};</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="4"><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">setPrototypeOf</span><span style="color: #666666">(</span><span style="color: #BD976A">car</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">dog</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="5"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="6"><span style="color: #BD976A">car</span><span style="color: #666666">.</span><span style="color: #80A665">bark</span><span style="color: #666666">();</span><span style="color: #DBD7CAEE"> </span><span style="color: #758575DD">// '짖기!'</span></span>
</code></pre> <h1 id="그래서-reflect-언제-사용될까"><a aria-hidden="true" tabindex="-1" href="#그래서-reflect-언제-사용될까"><span class="icon icon-link"></span></a>그래서 Reflect 언제 사용될까?</h1> <p>일반적인 프로그래밍에서는 잘 사용되지 않는다.
하지만 특수한 경우에서 아주 유용하게 사용된다.</p> <p>관련된 키워드로는 <code>메타 프로그래밍</code>, <code>의존성 주입</code>, <code>런타임 클래스 분석</code>등을 쉽게 찾아볼 수 있었다.</p> <h2 id="메타-프로그래밍이란"><a aria-hidden="true" tabindex="-1" href="#메타-프로그래밍이란"><span class="icon icon-link"></span></a>메타 프로그래밍이란</h2> <p>메타 프로그래밍은 <strong>코드가 코드를 다루는 프로그래밍</strong>이다. 다시 말해, 프로그래머가 직접 코드를 짜는 대신, 코드 자체가 자기 구조를 이해하고 수정하거나 행동을 동적으로 바꾸는 방식을 의미한다.</p> <p>일반적인 프로그래밍 보다는 프레임워크 개발, 라이브러리 개발등에서 주로 사용되는 것을 볼 수 있었다.</p> <p>자바스크립트에서는 <code>Proxy</code>, <code>Reflect</code>, 그리고 TypeScript의 <code>Decorator</code> 같은 기능을 활용해 메타 프로그래밍을 구현할 수 있다. 특히 TypeScript에서는 데코레이터를 통해 클래스나 속성, 메서드에 메타데이터를 부착할 수 있게 되는데, 이때 <code>reflect-metadata</code> 라이브러리가 핵심적인 역할을 한다.</p> <h1 id="reflect-metadata"><a aria-hidden="true" tabindex="-1" href="#reflect-metadata"><span class="icon icon-link"></span></a>reflect-metadata</h1> <p>TypeScript는 정적 타입 언어지만, 이 타입 정보는 <strong>컴파일 타임에만 존재</strong>한다.
JavaScript로 트랜스파일되고 나면, 타입 정보는 사라진다. 런타임에 클래스의 생성자 타입이나 프로퍼티의 타입을 알고 싶어도 알 수가 없다.</p> <p><code>reflect-metadata</code>는 바로 이 한계를 극복하기 위해 등장했다. 이 라이브러리는 <strong>런타임에 메타데이터를 저장하고 조회할 수 있는 API</strong>를 제공한다. 이를 통해 마치 자바나 C#처럼 클래스나 필드, 메서드에 부착된 타입 정보를 런타임에 활용할 수 있게 되는 것이다.</p> <h2 id="nestjs에서-reflect-metadata의-실제-활용"><a aria-hidden="true" tabindex="-1" href="#nestjs에서-reflect-metadata의-실제-활용"><span class="icon icon-link"></span></a>NestJS에서 reflect-metadata의 실제 활용</h2> <p>NestJS는 데코레이터 기반의 프레임워크다. 그리고 이 데코레이터 시스템이 제대로 동작하려면 클래스나 생성자, 파라미터에 대한 <strong>타입 정보가 런타임에 존재</strong>해야 한다.
NestJS는 바로 <code>reflect-metadata</code>를 통해 이 정보를 관리한다.</p> <p>예를 들어 다음과 같은 코드가 있다고 해보자.</p> <pre><code><span data-line-number="1"><span style="color: #666666">@</span><span style="color: #80A665">Injectable</span><span style="color: #666666">()</span></span>
<span data-line-number="2"><span style="color: #4D9375">export</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">UserService</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span></span>
<span data-line-number="3"><span style="color: #DBD7CAEE">  </span><span style="color: #CB7676">constructor</span><span style="color: #666666">(</span><span style="color: #CB7676">private</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">readonly</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">repository</span><span style="color: #666666">: </span><span style="color: #5DA9A7">UserRepository</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{}</span></span>
<span data-line-number="4"><span style="color: #666666">}</span></span>
</code></pre> <p>NestJS는 <code>UserService</code>를 인스턴스화할 때 <code>repo</code>에 어떤 타입이 들어가야 하는지를 알아야 한다. 이 정보를 얻기 위해 <code>Reflect.getMetadata('design:paramtypes', UserService)</code>를 호출하고, 그 결과로 <code>[UserRepository]</code>를 얻게 된다.</p> <p>이와 같은 방식으로 NestJS는 <strong>개발자가 명시적으로 객체를 주입하지 않아도</strong>, 내부적으로 의존성을 파악해 자동으로 인스턴스를 생성하고 연결할 수 있다.</p> <h2 id="nestjs의-injectable-흉내내기"><a aria-hidden="true" tabindex="-1" href="#nestjs의-injectable-흉내내기"><span class="icon icon-link"></span></a>Nestjs의 Injectable 흉내내기</h2> <p>아주 간단하게 Nestjs의 Injectable을 흉내내보았다.
Nestjs에서는 싱글턴으로 제공되지만 여기서 구현한 예제에서는 늘 새로운 인스턴스로 제공하는 코드다.</p> <pre><code><span data-line-number="1"><span style="color: #4D9375">import</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">reflect-metadata</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="2"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="3"><span style="color: #758575DD">// 메타데이터 키 정의  </span></span>
<span data-line-number="4"><span style="color: #CB7676">const </span><span style="color: #BD976A">INJECTABLE_KEY</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">custom:injectable</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="5"><span style="color: #CB7676">const </span><span style="color: #BD976A">PARAM_TYPES_KEY</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">design:paramtypes</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="6"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="7"><span style="color: #758575DD">// 클래스에 Injectable 메타데이터를 등록하는 데코레이터  </span></span>
<span data-line-number="8"><span style="color: #CB7676">function</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">Injectable</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="9"><span style="color: #DBD7CAEE">  </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">function</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">(</span><span style="color: #80A665">target</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Function</span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="10"><span style="color: #DBD7CAEE">    </span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">defineMetadata</span><span style="color: #666666">(</span><span style="color: #BD976A">INJECTABLE_KEY</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #4D9375">true</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">target</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="11"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">};</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="12"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="13"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="14"><span style="color: #758575DD">// 간단한 DI 컨테이너  </span></span>
<span data-line-number="15"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">DIContainer</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="16"><span style="color: #DBD7CAEE">  </span><span style="color: #CB7676">static</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">resolve</span><span style="color: #666666">&lt;</span><span style="color: #5DA9A7">T</span><span style="color: #666666">>(</span><span style="color: #BD976A">target</span><span style="color: #666666">: </span><span style="color: #4D9375">new</span><span style="color: #666666"> (...</span><span style="color: #BD976A">args</span><span style="color: #666666">: </span><span style="color: #5DA9A7">any</span><span style="color: #666666">[]) => </span><span style="color: #5DA9A7">T</span><span style="color: #666666">):</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">T</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="17"><span style="color: #666666">    </span><span style="color: #758575DD">// 생성자 파라미터 타입 가져오기  </span></span>
<span data-line-number="18"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">const </span><span style="color: #BD976A">tokens</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #BD976A">Reflect</span><span style="color: #666666">.</span><span style="color: #80A665">getMetadata</span><span style="color: #666666">(</span><span style="color: #BD976A">PARAM_TYPES_KEY</span><span style="color: #666666">,</span><span style="color: #CB7676"> </span><span style="color: #BD976A">target</span><span style="color: #666666">)</span><span style="color: #CB7676"> || </span><span style="color: #666666">[];</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="19"><span style="color: #DBD7CAEE">    </span><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #BD976A">tokens</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="20"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">const </span><span style="color: #BD976A">injections</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #BD976A">tokens</span><span style="color: #666666">.</span><span style="color: #80A665">map</span><span style="color: #666666">((</span><span style="color: #BD976A">token</span><span style="color: #666666">: </span><span style="color: #5DA9A7">any</span><span style="color: #666666">)</span><span style="color: #CB7676"> </span><span style="color: #666666">=></span><span style="color: #CB7676"> </span><span style="color: #BD976A">DIContainer</span><span style="color: #666666">.</span><span style="color: #80A665">resolve</span><span style="color: #666666">(</span><span style="color: #BD976A">token</span><span style="color: #666666">));</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="21"><span style="color: #DBD7CAEE">    </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">new</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">target</span><span style="color: #666666">(...</span><span style="color: #BD976A">injections</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="22"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="23"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="24"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="25"><span style="color: #666666">@</span><span style="color: #80A665">Injectable</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="26"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">Repository</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="27"><span style="color: #DBD7CAEE">  </span><span style="color: #80A665">getData</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="28"><span style="color: #DBD7CAEE">    </span><span style="color: #4D9375">return</span><span style="color: #DBD7CAEE"> </span><span style="color: #C98A7DAA">'</span><span style="color: #C98A7D">레포지토리 데이터</span><span style="color: #C98A7DAA">'</span><span style="color: #666666">;</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="29"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="30"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="31"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="32"><span style="color: #666666">@</span><span style="color: #80A665">Injectable</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="33"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">Service</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="34"><span style="color: #DBD7CAEE">  </span><span style="color: #CB7676">constructor</span><span style="color: #666666">(</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="35"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">private</span><span style="color: #DBD7CAEE"> </span><span style="color: #CB7676">readonly</span><span style="color: #DBD7CAEE"> </span><span style="color: #BD976A">repo</span><span style="color: #666666">: </span><span style="color: #5DA9A7">Repository</span><span style="color: #666666">,</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="36"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">)</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="37"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="38"><span style="color: #DBD7CAEE">  </span><span style="color: #80A665">execute</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="39"><span style="color: #DBD7CAEE">    </span><span style="color: #BD976A">console</span><span style="color: #666666">.</span><span style="color: #80A665">log</span><span style="color: #666666">(</span><span style="color: #C99076">this</span><span style="color: #666666">.</span><span style="color: #BD976A">repo</span><span style="color: #666666">.</span><span style="color: #80A665">getData</span><span style="color: #666666">());</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="40"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="41"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="42"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="43"><span style="color: #CB7676">class</span><span style="color: #DBD7CAEE"> </span><span style="color: #5DA9A7">App</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="44"><span style="color: #DBD7CAEE">  </span><span style="color: #80A665">run</span><span style="color: #666666">()</span><span style="color: #DBD7CAEE"> </span><span style="color: #666666">{</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="45"><span style="color: #DBD7CAEE">    </span><span style="color: #CB7676">const </span><span style="color: #BD976A">service</span><span style="color: #CB7676"> </span><span style="color: #666666">=</span><span style="color: #CB7676"> </span><span style="color: #BD976A">DIContainer</span><span style="color: #666666">.</span><span style="color: #80A665">resolve</span><span style="color: #666666">(</span><span style="color: #BD976A">Service</span><span style="color: #666666">);</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="46"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="47"><span style="color: #DBD7CAEE">    </span><span style="color: #BD976A">service</span><span style="color: #666666">.</span><span style="color: #80A665">execute</span><span style="color: #666666">();</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="48"><span style="color: #DBD7CAEE">  </span><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="49"><span style="color: #666666">}</span><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="50"><span style="color: #DBD7CAEE">  </span></span>
<span data-line-number="51"><span style="color: #CB7676">new</span><span style="color: #DBD7CAEE"> </span><span style="color: #80A665">App</span><span style="color: #666666">().</span><span style="color: #80A665">run</span><span style="color: #666666">();</span></span>
</code></pre> <p>코드를 간단하게 설명한다면</p> <ul><li><code>design:paramtypes</code> 은 reflect-metadata에서 데코레이터가 붙어있는 클래스에 자동으로 생성되는 키값이다. 생성자의 파라미터의 타입을 가져올 수 있다. <ul><li>이외에도 <code>design:returntype</code>, <code>design:type</code> 같은 키가 존재한다. 이와 관련된 정보는 <a href="https://github.com/microsoft/reflect-metadata" rel="nofollow">Reflect-Metadata : Github</a>에서 더 자세하게 알아볼 수 있다.</li></ul></li> <li>reflect-metadata로 가져온 타입을 이용하여 런타임에서 해당 정보로 주입할 인스턴스를 재귀적으로 생성하여 주입할 목록을 만들어 생성자에 파라미터로 제공해 최종 인스턴스를 반환하게 된다.</li></ul> <p>NestJS를 사용할 때 흔히 마주치는 오류 중 하나가 “의존성을 주입할 수 없습니다”는 에러다. 이 예제를 통해 NestJS가 어떻게 생성자 타입 정보를 읽어 의존성을 주입하는지, 왜 데코레이터와 타입 메타데이터 설정이 필수적인지를 이해할 수 있다.</p> <p>결국 NestJS의 의존성 주입 시스템의 기본 원리는 단순한 <code>reflect-metadata</code> 기반 메타프로그래밍에 있다는 점을 이 예제를 통해 확인할 수 있다. NestJS의 이해를 위해 이런 기초부터 직접 구현해보는 경험은 매우 유익했다.</p><!----></section> <footer class="border-t-border mt-24 border-t py-4"><section class="flex flex-wrap gap-2"><!--[--><a href="/blog?tag=Javascript" class="text-primary/50 hover:text-primary border-border hover:bg-accent flex items-center rounded-xl border px-1 text-sm transition-colors duration-200">#Javascript</a><a href="/blog?tag=Typescript" class="text-primary/50 hover:text-primary border-border hover:bg-accent flex items-center rounded-xl border px-1 text-sm transition-colors duration-200">#Typescript</a><a href="/blog?tag=Relect" class="text-primary/50 hover:text-primary border-border hover:bg-accent flex items-center rounded-xl border px-1 text-sm transition-colors duration-200">#Relect</a><a href="/blog?tag=Metaprogramming" class="text-primary/50 hover:text-primary border-border hover:bg-accent flex items-center rounded-xl border px-1 text-sm transition-colors duration-200">#Metaprogramming</a><!--]--></section></footer></article><!----><!----></main> <footer class="bg-muted"><div class="mx-auto flex flex-col items-center justify-between gap-4 p-4 text-gray-600 dark:text-gray-400"><div class="text-sm"><p>© 2025 markab-j. All rights reserved.</p></div> <div class="flex items-center space-x-4"><a href="https://github.com/markab-j" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile" class="hover:text-gray-900 dark:hover:text-gray-100"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-github"><!--[--><!----><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"><!----></path><!----><!----><path d="M9 18c-4.51 2-5-2-7-2"><!----></path><!----><!--]--><!----><!----></svg><!----></a> <a href="mailto:your-email@example.com" aria-label="Email" class="hover:text-gray-900 dark:hover:text-gray-100" rel="external"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-icon lucide lucide-mail"><!--[--><!----><path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7"><!----></path><!----><!----><rect x="2" y="4" width="20" height="16" rx="2"><!----></rect><!----><!--]--><!----><!----></svg><!----></a></div></div></footer><!----></div><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			<script>
				{
					__sveltekit_90nlyy = {
						base: new URL("..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					Promise.all([
						import("../_app/immutable/entry/start.ChMxvzUG.js"),
						import("../_app/immutable/entry/app.BFT2A5C2.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data: [null,null],
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
